---
title: 病毒的常见启动手段
author: St
categories:
- 病毒行为
- St
tags: 
- 病毒行为
date: 2020-10-23
excerpt: 几乎所有的病毒在侵入系统后，做的第一件事都是想办法实现自启动。本文对病毒的一些常见启动手段进行了总结。
---

# 前言

​	计算机病毒（Computer Virus）是编制者在计算机程序中插入的破坏计算机功能或者数据的代码，能影响计算机使用，能自我复制的一组计算机指令或者程序代码。简单来说，病毒就是一段具有恶意行为的可执行代码。当病毒侵入系统后，做的第一件事都是想办法实现自启动。下面简单介绍几种病毒的常见启动方式。

# 启动手段

## 1、欺骗用户点击

**快捷方式文件：**这种方式常见在U盘中，病毒往往会将U盘中原本的文件进行隐藏，然后创建和原文件具有相同文件名、相同图标的快捷方式。用户一旦不注意，点击了快捷方式，就会启动病毒。

![](\pic\zhangtaiming\病毒的常见启动手段\快捷方式.png)

**文件夹：**病毒文件的图标是文件夹的图标，但是其实是个可执行文件，后缀名是`.exe`。如果用户电脑设置不现实后缀名，就会将病毒当做文件夹打开。

![](\pic\zhangtaiming\病毒的常见启动手段\文件夹.png)

**开机启动目录：**windows系统有自带的快速启动文件夹，只要病毒把自身复制到快速启动文件夹中，系统在启动时就会自动地加载并运行相应的程序，实现开机自启动功能。

![](\pic\zhangtaiming\病毒的常见启动手段\启动项1.png)

## 2、注册表和服务

**注册表：**注册表是Windows系统中的一个重要数据库，用于存储系统和应用程序的设置信息。其中有部分键值可以实现开机启动，病毒将自身路径替换到其中，就可以实现开机自启动功能。下面是几个常见的自启动注册表键。

+ Run注册键：
  + `HKEY_CURRENT_USER\Software \Microsoft\Windows\CurrentVersion\Run`
  + `HKEY_LOCAL_MACHINE\SOFTWARE \Microsoft\Windows\CurrentVersion\Run`
+ RunOnce注册键：
  + `HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunOnce`
  + `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce`

 **系统服务：**很多病毒都喜欢将自身注册为系统服务，来获得更高的运行权限。只要系统启动后，这些病毒服务就会抢先启动。

![](\pic\zhangtaiming\病毒的常见启动手段\服务.png)

## 3、计划任务

​	Windows系统的计划任务，可以将任何脚本、程序或文档安排在某个时间来自动运行。有些病毒会利用这一机制，来实现自启动。计划任务除了可以启动可执行文件，还可以直接运行一些脚本命令，通过命令来下载病毒运行后再删除病毒，这么做的好处在于计算机内没有病毒文件，不会被杀毒软件扫描到。

![](\pic\zhangtaiming\病毒的常见启动手段\计划任务.png)

## 4、映像劫持

​	映像劫持，也被称为「IFEO」（Image File Execution Options）。当目标程序被映像劫持时，双击目标程序，系统会转而运行劫持程序，并不会运行目标程序。许多病毒会利用这一点来抑制杀毒软件的运行，并运行自己的程序。

​	造成映像劫持的罪魁祸首就是参数「Debugger」，它是 IFEO 里第一个被处理的参数，系统如果发现某个程序文件在 IFEO 列表中，它就会首先来读取 Debugger 参数，如果该参数不为空，系统则会把 Debugger 参数里指定的程序文件名作为用户试图启动的程序执行请求来处理，而仅仅把用户试图启动的程序作为 Debugger 参数里指定的程序文件名的参数发送过去。

​	实现的简单操作就是修改注册表。比如，在`「HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Option」`中添加 chrome.exe 项，在此项中添加 debugger 键，键值为QQ程序路径。设置好之后后，双击chrome.exe并不会打开谷歌浏览器，而是运行QQ。

![](\pic\zhangtaiming\病毒的常见启动手段\映像劫持.png)